from flask import Flask, render_template, request, jsonify
import datetime
import pytz
import requests
from fuzzywuzzy import fuzz
import random

app = Flask(__name__)

# --- ุฑุฏูุฏ ุงูุชุญูุฉ ---
greetings = ["ููุง ูุงููู ๐", "ุฃููุงู ูุณููุงู ๐", "ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ๐ค", "ูุฑุญุจุง ุจู!", "ูุง ูุฑุญุจุง ูุณููุง โจ"]

    # --- ูููุงุช ููุชุงุญูุฉ ---
def is_time_question(msg):
        return any(fuzz.partial_ratio(msg, kw) > 80 for kw in [
        "ุงูุณุงุนุฉ ูู", "ูู ุงูููุช", "ูู ุงูุณุงุนุฉ", "ุนุทููู ุงูููุช", "ุฅูุด ุงูุณุงุนุฉ", "ุฅูุด ุงูููุช",
        "ูุฏูุด ุงูุณุงุนุฉ", "ูุฏูุด ุงูููุช", "ูุด ุงูุณุงุนุฉ", "ูุด ุงูููุช", "ูู ุงูุณุงุนุฉ ุงูุญูู",
        "ูุฏ ุฅูุด ุงูุณุงุนุฉ", "ูู ุงูุณุงุนุฉ ุงูุขู", "ุงูุด ุงูููุช ุงูุญูู", "ูู ุตุงุฑุช ุงูุณุงุนุฉ",
        "ูู ุงูููุช ุงูุญูู", "ุงูุณุงุนุฉ ูุงู", "ุงูููุช ูุงู", "ูุงู ุงูุณุงุนุฉ", "ูุงู ุงูููุช",
        "ุงูุณุงุนู ุจูุช ูุงู", "ุจููุช ุงูุณุงุนุฉ ูุงู", "ุจููุช ูุงู ุฏูููุชู", "ุงูุณุงุนุฉ ุฏูููุชู ูุงู",
        "ุฅูู ุงูููุช ุฏูููุชู", "ุงูููุช ุฏูููุชู ูุงู", "ูุฏูุด ุตุงุฑ ุงูููุช", "ุฃุฏูุด ุงูุณุงุนุฉ",
        "ุดู ุงูุณุงุนุฉ", "ูุฏู ูุฏูุด ุงูุณุงุนุฉ", "ุงูููุช ุฅููุชู", "ุดู ุตุงุฑ ุงูููุช", "ูุฏูุด ุตุงุฑุช ุงูุณุงุนุฉ",
        "ูู ุฃู ุณุงุนุฉ ุฅุญูุง", "ุฅุฏู ุงูุณุงุนุฉ ููู", "ุฃููุชู ุตุฑูุง", "ูุงุด ุงูุณุงุนุฉ", "ุดูู ุงูุณุงุนุฉ",
        "ุดูู ุงูููุช", "ูุงุด ุญุงู ุงูุณุงุนุฉ", "ูุงุด ุญุงู ุงูููุช", "ุงุดุญุงู ุงูุณุงุนุฉ", "ุงุดุญุงู ุงูููุช",
        "ูุงุด ุญุงู ุงูุณุงุนุฉ", "ูุงุด ุญุงู ุงูููุช", "ุดูู ุฏุงุจุง ุงูุณุงุนุฉ", "ุดูู ุฏุงุจุง ุงูููุช",
        "ุงูุณุงุนุฉ ุดุญุงู ุฏุงุจุง", "ุงูููุช ุดุญุงู ุฏุงุจุง", "ุงูุณุงุนุฉ ุดุญุงู", "ุดุญุงู ุงูุณุงุนุฉ",
        "ูุฏุงู ุงูุณุงุนุฉ", "ูุฏุงู ุงูููุช", "ูุฏุงู ูุตููุง ูู ุงูุณุงุนุฉ", "ูุง ุชุฑู ุงูุณุงุนุฉ ูุงู",
        "ุนุทููู ูู ุงูุณุงุนุฉ", "ูููู ุงุนุฑู ุงูุณุงุนุฉ", "ูุด ุตุงุฑุช ุงูุณุงุนุฉ", "ุตุงุฑุช ูู ุงูุณุงุนุฉ",
        "ุตุงุฑ ุงูููุช ูุชุฃุฎุฑุ", "ูู ุชุฃุฎุฑ ุงูููุชุ", "ุงูุณุงุนุฉ ุงูุขู ูู", "ุงูููุช ุงูุขู ูู",
        "ุนุทูู ุงูููุช ุจุงููู", "ูู ุจุงูู ุนูู ุงูููุช", "ูุฏ ุฅูุด ุงูููุช", "ุงู ุณุงุนุฉ ุงูุญูู",
        "ูุด ุงูููุช ุงูุญูู", "ุงูุณุงุนุฉ ุดูุฏ", "ุดูุฏ ุตุงุฑ ุงูููุช", "ุงุดูุฏ ุงูุณุงุนุฉ", "ุดูุฏ ุงูููุช",
        "ุงูุณุงุนุฉ ฺู", "ฺู ุงูุณุงุนุฉ", "ุงูููุช ฺู"
    ]

    )

def is_weather_question(msg):
        return any(fuzz.partial_ratio(msg, kw) > 80 for kw in [
        "ุงูุฌู", "ุงูุทูุณ", "ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ", "ููู ุงูุทูุณ", "ููู ุงูุฌู", "ูุด ุงูุทูุณ", "ูุด ุงูุฌู",
        "ุงูุด ุงูุทูุณ", "ุงูุด ุงูุฌู", "ููู ุญุงู ุงูุทูุณ", "ููู ุญุงู ุงูุฌู", "ููู ุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ",
        "ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู", "ุงูุด ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ", "ูุด ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ", "ูุฏูุด ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ",
        "ุงูุฌู ุงูููู", "ุงูุทูุณ ุงูููู", "ููู ุงูุงุฌูุงุก", "ุฅูุด ุงูุฃุฌูุงุก", "ููู ุงูุฌู ุจุฑุง",
        "ุญุฑ ููุง ุจุฑุฏ", "ุงูุฌู ุญุฑ", "ุงูุฌู ุจุงุฑุฏ", "ุงูุฏููุง ุญุฑ", "ุงูุฏููุง ุจุฑุฏ", "ููู ุงูุฌู ุนูุฏูู",
        "ููู ุงูุทูุณ ุนูุฏู", "ุงูุฏููุง ุนุงููุฉ ุงูู", "ุงูุฏููุง ุญุฑ ููุง ุจุฑุฏ", "ุงูุฏููุง ุญุฑุงูุฉ", "ุงูุฏููุง ุณุงูุนุฉ",
        "ุงูุฌู ูุบูู", "ุงูุฌู ูุดูุณ", "ุงูุฌู ููุทุฑ", "ููู ูุทุฑ", "ููู ุดูุณ", "ููู ุจุฑุฏ", "ููู ุญุฑ",
        "ุจุฑุฏ ููุง ุญุฑ", "ุงูุฌู ููููุฑ", "ุงูุฌู ุญูู", "ุงูุฌู ูู ุญูู", "ุงูุฌู ูุด ููุง ุจุฏ",
        "ููู ุงูุทูุณ ุงูุญูู", "ููู ุงูุญุฑุงุฑุฉ", "ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุงูุญูู ูู", "ุงูุฏููุง ุชูุฌ",
        "ุงูุฏููุง ุณุฎูุฉ", "ุงูุฏููุง ูุณูุฑุฉ", "ูุฏุง ุญุฑ ููุช", "ูุฏุง ุจุฑุฏ ููุช", "ุญุฑ ููุช",
        "ุจุฑุฏ ูุงุฑุต", "ุงูุฌู ุนุงูู ุงุฒุงู", "ุงูุฌู ูุงูู", "ุงูุฌู ุฒูู", "ุงูุฏููุง ูุดูุณุฉ",
        "ุงูุฏููุง ูุบุจุฑุฉ", "ุงูุฏููุง ูุทุฑ", "ุงูุฌู ูุบุจุด", "ุดูู ุญุงูุฉ ุงูุทูุณ", "ุดูู ุงูุฌู",
        "ุฃุดูู ุงูุทูุณ", "ูุงุด ุงูุฌู", "ูุงุด ุงูุทูุณ", "ููู ุงูุทูุณ ุฏุงุจุง", "ุงูุฌู ุจุงุฑุฏ ุจุฒุงู",
        "ุงูุฌู ุณุฎูู ุจุฒุงู", "ูููุงุด ุงูุทูุณ", "ุดูู ุญุงูุฉ ุงูุฌู", "ุงูุฏููุง ูู ุฏุงูุฑุฉ",
        "ุงูุจุฑุฏ ูุงุฑุณ", "ุญุฑ ุดุฏูุฏ", "ุตูุฏ ุงูููู", "ุงูุฌู ูุฒูู", "ุจุฑุฏุงููู", "ุญุฑุงููู",
        "ุดูู ุงูุฌู ุนูุฏู", "ุดูู ุญุงูุฉ ุงูุณูุง", "ูุงูู ุดุชุง", "ูุงูู ุงูุจุฑุฏ", "ูุงูู ุงูุญุฑ",
        "ุงูุฌู ูุบูู ุจุฒุงู", "ุฑุทูุจุฉ ุนุงููุฉ", "ุงูุฌู ุฑุทุจ", "ุงูุฌู ุฌุงู", "ุงูููู ูุบูู",
        "ุงูููู ูุดูุณ", "ุงูููู ูุงุทุฑ", "ุงูุฌู ููุณุฑ ุงูุนุธู", "ุงูุฌู ูุงุฑ", "ุงูุฌู ูุฑูุฒุฑ"
    ]
    )

def is_greeting(msg):
        return any(fuzz.partial_ratio(msg, kw) > 80 for kw in [
        "ุงูุณูุงู ุนูููู", "ุนูููู ุงูุณูุงู", "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู", "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู",
        "ููุง", "ููุง ูุงููู", "ููุง ูุบูุง", "ุฃููุงู", "ุฃููุง ูุณููุง", "ุฃููุงูู", "ุฃููุง ูุณููุง ููู",
        "ุตุจุงุญ ุงูุฎูุฑ", "ุตุจุงุญ ุงูููุฑ", "ุตุจุงุญ ุงููุฑุฏ", "ุตุจุงุญ ุงููู", "ุตุจุงุญ ุงููุฑุฏ ูุงููุงุณููู",
        "ุตุจุงุญ ุงููุดุงุท", "ุตุจุงุญ ุงูุนุณู", "ุตุจุงุญ ุงูุญุจ", "ุตุจุงุญ ุงูุฌูุงู",
        "ูุณุงุก ุงูุฎูุฑ", "ูุณุงุก ุงูููุฑ", "ูุณุงุก ุงููุฑุฏ", "ูุณุงุก ุงููู", "ูุณุงุก ุงูุนุณู",
        "ูุณุงุก ุงูุญุจ", "ูุณุงุก ุงูุณุนุงุฏุฉ", "ูุณุงุก ุงูุฌูุงู", "ูุณุงุก ุงููุฑุญ", "ูุณุงุก ุงูุงููุงุฑ",
        "ุตุจุงุญู", "ูุณุงุคู", "ูุณุนุฏ ุตุจุงุญู", "ูุณุนุฏ ูุณุงู", "ููุงุฑู ุณุนูุฏ", "ูุณุงุก ุงููุงุณููู",
        "ูุง ููุง", "ูุงููุง ูุบูุง", "ุญู ุงููู", "ุญููุงู ุงููู", "ูุฑุญุจุง", "ูุฑุญุจุชูู",
        "ูุฑุญุจุง ููููู", "ูุง ุตุจุงุญ ุงูุฎูุฑ", "ูุง ูุณุงุก ุงูุฎูุฑ", "ููู ุงูุญุงู", "ุดูููู",
        "ุฃูููู ูุณูููู", "ููุฑ ุงูููุงู", "ุฃูุณุชููุง", "ููุฑุช", "ููุฑุชููุง", "ุฃุดุฑูุช ุงูุฃููุงุฑ",
        "ุตุจุงุญ ุงููู ูุงููุงุณููู", "ุตุจุงุญ ุงูุฑุถุง", "ุตุจุงุญ ุงููุญุจุฉ", "ุตุจุงุญูู ุณูุฑ",
        "ูุณุงุก ุงูุทูุจูู", "ูุณุงุก ุงูุฃุญุจุงุจ", "ูุณุงุก ุงููุฑุฏ ููุฌููุน", "ูุณุงุก ุงููููุฉ",
        "ุตุจุงุญ ุงููููุฉ", "ุตุจุงุญ ุงููุทุฑ", "ุตุจุงุญ ุงูุชูุงุคู", "ุตุจุงุญ ุงูุจูุฌุฉ"
    ]
    )

def is_wikipedia(msg):
        return "ุงุจุญุซ ูู ููููุจูุฏูุง ุนู" in msg

def is_translate(msg):
        return "ุชุฑุฌู" in msg and "ุฅูู" in msg

def is_salah(msg):
        return any(fuzz.partial_ratio(msg, kw) > 80 for kw in [
        "ูุชู ุตูุงุฉ", "ูุชู ุฃุฐุงู", "ูุชู ุงููุฌุฑ", "ููุช ุงูุตูุงุฉ", "ููุงููุช ุงูุตูุงุฉ",
        "ูุชู ุตูุงุฉ ุงููุฌุฑ", "ูุชู ุตูุงุฉ ุงูุธูุฑ", "ูุชู ุตูุงุฉ ุงูุนุตุฑ", "ูุชู ุตูุงุฉ ุงููุบุฑุจ", "ูุชู ุตูุงุฉ ุงูุนุดุงุก",
        "ูุชู ุฃุฐุงู ุงููุฌุฑ", "ูุชู ุฃุฐุงู ุงูุธูุฑ", "ูุชู ุฃุฐุงู ุงูุนุตุฑ", "ูุชู ุฃุฐุงู ุงููุบุฑุจ", "ูุชู ุฃุฐุงู ุงูุนุดุงุก",
        "ููุช ุตูุงุฉ ุงููุฌุฑ", "ููุช ุตูุงุฉ ุงูุธูุฑ", "ููุช ุตูุงุฉ ุงูุนุตุฑ", "ููุช ุตูุงุฉ ุงููุบุฑุจ", "ููุช ุตูุงุฉ ุงูุนุดุงุก",
        "ููุงููุช ุตูุงุฉ ุงูููู", "ููุงููุช ุงูุตูุงุฉ ุงูููู", "ูุชู ุงูุฃุฐุงู ุงูุฌุงู", "ูุชู ูุฑูุน ุงูุฃุฐุงู",
        "ูุชู ูุฃุฐู", "ูุชู ูุฃุฐู ุงููุฌุฑ", "ูุชู ูุฃุฐู ุงูุธูุฑ", "ูุชู ูุฃุฐู ุงูุนุตุฑ", "ูุชู ูุฃุฐู ุงููุบุฑุจ", "ูุชู ูุฃุฐู ุงูุนุดุงุก",
        "ูู ุจุงูู ุนูู ุงูุตูุงุฉ", "ูุฏูุด ุจุงูู ุนูู ุงูุตูุงุฉ", "ูุฏูุด ุจุงูู ุนูู ุงูุฃุฐุงู", "ุงูุด ููุช ุงูุตูุงุฉ",
        "ุงูุชู ุงูุตูุงุฉ", "ุงูุชู ุงูุฃุฐุงู", "ุงูุชู ุตูุงุฉ ุงููุฌุฑ", "ุงูุชู ุตูุงุฉ ุงูุธูุฑ", "ุงูุชู ุตูุงุฉ ุงูุนุตุฑ", "ุงูุชู ุตูุงุฉ ุงููุบุฑุจ", "ุงูุชู ุตูุงุฉ ุงูุนุดุงุก",
        "ูุชู ุตูุงุฉ ุงูุตุจุญ", "ููุช ุตูุงุฉ ุงูุตุจุญ", "ูุชู ุงููุฌุฑ ูุฃุฐู", "ูุชู ุตูุงุฉ ุงููุฌุฑ ุงูููู",
        "ููุงุนูุฏ ุงูุตูุงุฉ", "ููุงุนูุฏ ุงูุฃุฐุงู", "ุฃููุงุช ุงูุตูุงุฉ", "ุฃููุงุช ุงูุฃุฐุงู",
        "ูุชู ุงูุตูุงุฉ ุงูุฌุงูุฉ", "ุงูุด ุงูุตูุงุฉ ุงูุฌุงูุฉ", "ูุด ุงูุตูุงุฉ ุงูุฌุงูุฉ",
        "ุงูุงุฐุงู ูุชู", "ูุชู ูุงุฐู", "ูุชู ูุงุฐู ุงููุฌุฑ", "ูุชู ุจูุฃุฐู", "ูุชู ุจูุฃุฐู ุงููุฌุฑ",
        "ููุช ุงูุตูุงุฉ ุงูุญูู", "ูุชู ููุช ุงูุตูุงุฉ", "ูุชู ุจูุฃุฐู ุงูุธูุฑ", "ูุชู ุจูุฃุฐู ุงูุนุตุฑ",
        "ูุชู ุขุฐุงู ุงูุนุดุงุก", "ูุชู ุขุฐุงู ุงููุบุฑุจ", "ุตูุงุฉ ุงููุฌุฑ ูุชู", "ุตูุงุฉ ุงููุบุฑุจ ูุชู",
        "ุงูุขุฐุงู ุงูุฌุงู ูุชู", "ุงูุตูุงุฉ ุงูุฌุงูุฉ ูุชู", "ุงุฏุนููู ููุช ุงูุตูุงุฉ", "ุงูุตูุงุฉ ูุชู ููุชูุง",
        "ูุชู ูุตูู", "ูุชู ุชุฌู ุงูุตูุงุฉ", "ูุชู ููุงู ุงูุฃุฐุงู", "ูุชู ุชูุงู ุงูุตูุงุฉ", "ูุชู ุงูุตูุงุฉ ุงูุฌุงูุฉ"
    ]
    )

def is_open_site(msg):
        sites = [
      "ููุชููุจ",
      "ูููู",
      "ุงูุณุชูุฑุงู",
      "ุชููุชุฑ",
      "ูุชูููุณ",
      "ุณุจูุชููุงู",
      "ูููุน ุฏุงุฑ ุงูุชุฑุจูุฉ",
      "ูููุน ุฏุงุฑ ุงูุชุฑุจูู",
      "ูุธุงู ููุฑ",
      "ุงูุฑูุงุถ",
      "ุฌุฑูุฏุฉ ุงูุดุฑู ุงูุฃูุณุท",
      "ุตุญููุฉ ุงููุทู",
      "ุณุจู",
      "ูููุน ุณุนูุฏู",
      "ูููุน ูุฒุงุฑุฉ ุงูุฏุงุฎููุฉ ุงูุณุนูุฏูุฉ",
      "ูููุน ูุฒุงุฑุฉ ุงูุตุญุฉ ุงูุณุนูุฏูุฉ",
      "ูููุน ูุฒุงุฑุฉ ุงูุชุนููู ุงูุณุนูุฏูุฉ",
      "ูููุน ุฃุจุดุฑ",
      "ูููุน ููุฆุฉ ุงูุณูู ุงููุงููุฉ",
      "ูููุน ุฅูุงุฑุฉ ููุฉ",
      "ูููุน ุฅูุงุฑุฉ ุงูุฑูุงุถ",
      "ูููุน ูุฒุงุฑุฉ ุงูุฅุณูุงู ุงูุณุนูุฏูุฉ",
      "ูููุน ููุฆุฉ ุงูุชุฑููู",
      "ูููุน ุงููุฑุณุงู",
      "ูููุน ุณูุฏุชู",
      "ูููุน ููุฑุจุณ ุงูุณุนูุฏูุฉ",
      "ูููุน ุนูุงุธ",
      "ูููุน ุณูุฑูู",
      "ูููุน ููุดุงุช",
      "ูููุน ุชู ุนุฑุจู",
      "ูููุน ุดูู 360",
      "ูููุน ุฃุฑุงููู ุงูุณุนูุฏูุฉ",
      "ูููุน ุฑูุชุงูุง",
      "ูููุน ูุฌููุนุฉ ุณูุฑุง",
      "ูููุน ุฌุฑูุฏุฉ ุงููุฏููุฉ",
      "ูููุน ุงูุญุตููู",
      "ูููุน ุงูุณุนูุฏูุฉ ุงูููู",
      "ูููุน ุฎุจุฑูู",
      "ูููุน ุณูู.ููู",
      "ูููุน ููุดู",
      "ูููุน ุฌููู ุดูู",
      "ูููุน ุญุฑุงุฌ",
      "ูููุน ุงูุณุชุฑุง",
      "ูููุน ููู",
      "ูููุน ุจูุฏู",
      "ูููุน ูุงุฑูู ูููููุฒ",
      "ูููุน ุณุจูุงุด",
      "ูููุน ุฏูุจููุงูุฒ",
      "ูููุน ุงููุคุณุณุฉ ุงูุนุงูุฉ ููุชุฃูููุงุช ุงูุงุฌุชูุงุนูุฉ",
      "ูููุน ุงูุจูู ุงูุฃููู ุงูุณุนูุฏู",
      "ูููุน ุจูู ุงูุฑูุงุถ",
      "ูููุน ุจูู ุณุงุจ",
      "ูููุน ูุฑูุฒ ุงูููู ุนุจุฏ ุงููู ููุฏุฑุงุณุงุช",
      "ูููุน ูุณุชุดูู ุงูููู ููุตู ุงูุชุฎุตุตู",
      "ูููุน ุงูุณุนูุฏูุฉ ููุณูุงุญุฉ",
      "ูููุน ุงูุชุฃูููุงุช ุงูุงุฌุชูุงุนูุฉ",
      "ูููุน ููุฆุฉ ุงูุงุชุตุงูุงุช ูุชูููุฉ ุงููุนูููุงุช",
      "ูููุน ุงููุฑูุฒ ุงููุทูู ููููุงูุฉ ูู ุงูุฃูุฑุงุถ",
      "ูููุน ุฌูุงุฒุงุช ุงูุณุนูุฏูุฉ",
      "ูููุน ุดุฑูุฉ ุงูุงุชุตุงูุงุช ุงูุณุนูุฏูุฉ (STC)",
      "ูููุน ููุจุงููู",
      "ูููุน ุฒูู ุงูุณุนูุฏูุฉ",
      "ูููุน ุดุฑูุฉ ุฃุฑุงููู",
      "ูููุน ุงูุงุชุญุงุฏ ุงูุณุนูุฏู ููุฑุฉ ุงููุฏู"
    ]
        return any(site in msg for site in sites)

def extract_city(msg):
        for word in msg.split():
            if word in ["ุงูุฑูุงุถ", "ุฌุฏุฉ", "ููุฉ", "ุงูุฏูุงู", "ุงููุฏููุฉ", "ุงููุตูู", "ุงูุฎุจุฑ"]:
                return word
        return "ุงูุฑูุงุถ"

    # --- ุงููุธุงุฆู ---
def get_time():
        now = datetime.datetime.now(pytz.timezone("Asia/Riyadh"))
        return f"๐ ุงูุณุงุนุฉ ุงูุขู: {now.strftime('%I:%M %p')}"

def developer_response():
        return "ุชู ุชุทููุฑู ุจูู ุญุจ ูุดุบู ุจูุงุณุทุฉ: ุฃุณุงูุฉ ุจุฎุดุ ุนูู ุงูุบุงูุฏูุ ูุญูุฏ ูุณููุ ุญุณู ุงููุดุฌุฑูุ ูุฑุจูุน ูุณุชู. ุดูุฑุงู ููู! ๐"

def get_weather(city):
        try:
            res = requests.get(f"https://wttr.in/{city}?format=3")
            return f"๐ค๏ธ {res.text.strip()}"
        except:
            return "ุนุฐุฑูุงุ ุชุนุฐุฑ ุงูุญุตูู ุนูู ุญุงูุฉ ุงูุทูุณ."

def get_salah(city):
        try:
            url = f"https://api.aladhan.com/v1/timingsByCity?city={city}&country=Saudi Arabia&method=4"
            data = requests.get(url).json()
            times = data['data']['timings']
            return f"""๐ ููุงููุช ุงูุตูุงุฉ ูู {city}:
    ุงููุฌุฑ: {times['Fajr']}
    ุงูุธูุฑ: {times['Dhuhr']}
    ุงูุนุตุฑ: {times['Asr']}
    ุงููุบุฑุจ: {times['Maghrib']}
    ุงูุนุดุงุก: {times['Isha']}"""
        except:
            return "ูุง ูุฏุฑุช ุฃุฌูุจ ููุงููุช ุงูุตูุงุฉ ุญุงูููุง."

def wiki_search(msg):
        try:
            query = msg.split("ุนู", 1)[1].strip()
            url = f"https://ar.wikipedia.org/api/rest_v1/page/summary/{query}"
            res = requests.get(url).json()
            return res.get("extract", "ูู ุฃุฌุฏ ูุชูุฌุฉ ูู ููููุจูุฏูุง.")
        except:
            return "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุจุญุซ ูู ููููุจูุฏูุง."

def translate(msg):
        try:
            text = msg.split("ุชุฑุฌู",1)[1].split("ุฅูู")[0].strip()
            target = msg.split("ุฅูู",1)[1].strip()
            res = requests.get(f"https://api.mymemory.translated.net/get?q={text}&langpair=ar|{target}")
            trans = res.json()["responseData"]["translatedText"]
            return f"๐ ุงูุชุฑุฌูุฉ: {trans}"
        except:
            return "ุชุนุฐุฑ ุงูุชุฑุฌูุฉ ุงูุขู."


def open_website(msg):
        links = {
            "ููุชููุจ": "https://www.youtube.com",
            "ูููู": "https://www.google.com",
            "ุงูุณุชูุฑุงู": "https://www.instagram.com",
            "ุชููุชุฑ": "https://twitter.com",
            "ูุชูููุณ": "https://www.netflix.com",
            "ุณุจูุชููุงู": "https://www.spotify.com",
            "ูููุน ุฏุงุฑ ุงูุชุฑุจูุฉ": "https://dt.edu.sa",
            "ูููุน ุฏุงุฑ ุงูุชุฑุจูู": "https://dt.edu.sa",
            "ูุธุงู ููุฑ": "https://noor.moe.gov.sa/Noor/EduWaveLanding/Home.aspx",

            # ููุงูุน ุณุนูุฏูุฉ ูุดููุฑุฉ
            "ุงูุฑูุงุถ": "https://www.alriyadh.com",
            "ุฌุฑูุฏุฉ ุงูุดุฑู ุงูุฃูุณุท": "https://aawsat.com",
            "ุตุญููุฉ ุงููุทู": "https://www.alwatan.com.sa",
            "ุณุจู": "https://sabq.org",
            "ูููุน ุณุนูุฏู": "https://www.saudigov.sa",
            "ูููุน ูุฒุงุฑุฉ ุงูุฏุงุฎููุฉ ุงูุณุนูุฏูุฉ": "https://www.moi.gov.sa",
            "ูููุน ูุฒุงุฑุฉ ุงูุตุญุฉ ุงูุณุนูุฏูุฉ": "https://www.moh.gov.sa",
            "ูููุน ูุฒุงุฑุฉ ุงูุชุนููู ุงูุณุนูุฏูุฉ": "https://www.moe.gov.sa",
            "ูููุน ุฃุจุดุฑ": "https://www.absher.sa",
            "ูููุน ููุฆุฉ ุงูุณูู ุงููุงููุฉ": "https://www.cma.org.sa",
            "ูููุน ุฅูุงุฑุฉ ููุฉ": "https://makkah.gov.sa",
            "ูููุน ุฅูุงุฑุฉ ุงูุฑูุงุถ": "https://www.riyadh.gov.sa",
            "ูููุน ูุฒุงุฑุฉ ุงูุฅุณูุงู ุงูุณุนูุฏูุฉ": "https://www.housing.gov.sa",
            "ูููุน ููุฆุฉ ุงูุชุฑููู": "https://www.saudigov.sa/entertainment",

            # ููุงูุน ุณุนูุฏูุฉ ูุชูุณุทุฉ ุงูุดูุฑุฉ
            "ูููุน ุงููุฑุณุงู": "https://www.almrsal.com",
            "ูููุน ุณูุฏุชู": "https://www.sayidaty.net",
            "ูููุน ููุฑุจุณ ุงูุณุนูุฏูุฉ": "https://www.forbesmiddleeast.com",
            "ูููุน ุนูุงุธ": "https://www.okaz.com.sa",
            "ูููุน ุณูุฑูู": "https://www.screen.sa",
            "ูููุน ููุดุงุช": "https://www.mekshat.com",
            "ูููุน ุชู ุนุฑุจู": "https://www.tech-arabia.com",
            "ูููุน ุดูู 360": "https://www.shof360.com",
            "ูููุน ุฃุฑุงููู ุงูุณุนูุฏูุฉ": "https://www.aramco.com",
            "ูููุน ุฑูุชุงูุง": "https://www.rotana.net",
            "ูููุน ูุฌููุนุฉ ุณูุฑุง": "https://www.safarat.com",
            "ูููุน ุฌุฑูุฏุฉ ุงููุฏููุฉ": "https://www.al-madina.com",
            "ูููุน ุงูุญุตููู": "https://www.alhussayni.com",
            "ูููุน ุงูุณุนูุฏูุฉ ุงูููู": "https://www.saudigov.com",
            "ูููุน ุฎุจุฑูู": "https://www.khaberni.com",

            # ููุงูุน ููุชุณูู ุงูุฅููุชุฑููู ูู ุงูุณุนูุฏูุฉ
            "ูููุน ุณูู.ููู": "https://www.souq.com/sa",
            "ูููุน ููุดู": "https://www.namshi.com/sa",
            "ูููุน ุฌููู ุดูู": "https://www.jollychic.com",
            "ูููุน ุญุฑุงุฌ": "https://www.haraj.com.sa",
            "ูููุน ุงูุณุชุฑุง": "https://www.extra.com",
            "ูููุน ููู": "https://www.noon.com",
            "ูููุน ุจูุฏู": "https://www.panda.sa",
            "ูููุน ูุงุฑูู ูููููุฒ": "https://www.harveynichols.com.sa",
            "ูููุน ุณุจูุงุด": "https://www.splashfashions.com",
            "ูููุน ุฏูุจููุงูุฒ": "https://www.debenhams.com.sa",

            # ููุงูุน ุฎุฏูุงุชูุฉ ููุคุณุณุงุช ุณุนูุฏูุฉ
            "ูููุน ุงููุคุณุณุฉ ุงูุนุงูุฉ ููุชุฃูููุงุช ุงูุงุฌุชูุงุนูุฉ": "https://www.gosi.gov.sa",
            "ูููุน ุงูุจูู ุงูุฃููู ุงูุณุนูุฏู": "https://www.alahli.com",
            "ูููุน ุจูู ุงูุฑูุงุถ": "https://www.riyadbank.com",
            "ูููุน ุจูู ุณุงุจ": "https://www.sabb.com",
            "ูููุน ูุฑูุฒ ุงูููู ุนุจุฏ ุงููู ููุฏุฑุงุณุงุช": "https://www.ksau-hs.edu.sa",
            "ูููุน ูุณุชุดูู ุงูููู ููุตู ุงูุชุฎุตุตู": "https://www.kfshrc.edu.sa",
            "ูููุน ุงูุณุนูุฏูุฉ ููุณูุงุญุฉ": "https://www.sauditourism.sa",
            "ูููุน ุงูุชุฃูููุงุช ุงูุงุฌุชูุงุนูุฉ": "https://www.gosi.gov.sa",
            "ูููุน ููุฆุฉ ุงูุงุชุตุงูุงุช ูุชูููุฉ ุงููุนูููุงุช": "https://www.citc.gov.sa",
            "ูููุน ุงููุฑูุฒ ุงููุทูู ููููุงูุฉ ูู ุงูุฃูุฑุงุถ": "https://www.nccp.sa",

            # ููุงูุน ูุญููุฉ ุฃุฎุฑู
            "ูููุน ุฌูุงุฒุงุช ุงูุณุนูุฏูุฉ": "https://www.gdp.gov.sa",
            "ูููุน ุดุฑูุฉ ุงูุงุชุตุงูุงุช ุงูุณุนูุฏูุฉ (STC)": "https://www.stc.com.sa",
            "ูููุน ููุจุงููู": "https://www.mobily.com.sa",
            "ูููุน ุฒูู ุงูุณุนูุฏูุฉ": "https://www.sa.zain.com",
            "ูููุน ุดุฑูุฉ ุฃุฑุงููู": "https://www.saudiaramco.com",
            "ูููุน ุงูุงุชุญุงุฏ ุงูุณุนูุฏู ููุฑุฉ ุงููุฏู": "https://www.saff.com.sa"
        }

        for word, url in links.items():
            if word in msg:
                return {
                    "reply": f"โ ุชู ูุชุญ {word} ๐",
                    "link": url
                }
        return {"reply": "โ ุงููููุน ุบูุฑ ูุนุฑูู."}

    # --- ูุงุฌูุฉ ุงููุณุชุฎุฏู ---
@app.route("/")
def index():
        return render_template("index.html")

@app.route("/ask", methods=["POST"])
def ask():
        msg = request.json["message"].strip()

        if is_greeting(msg):
            return jsonify({"reply": random.choice(greetings)})

        elif is_time_question(msg):
            return jsonify({"reply": get_time()})

        elif is_weather_question(msg):
            return jsonify({"reply": get_weather(extract_city(msg))})

        elif is_salah(msg):
            return jsonify({"reply": get_salah(extract_city(msg))})

        elif is_wikipedia(msg):
            return jsonify({"reply": wiki_search(msg)})

        elif is_translate(msg):
            return jsonify({"reply": translate(msg)})

        elif is_open_site(msg):
            return jsonify(open_website(msg))

        return jsonify({"reply": "ูู ุฃููู ุณุคุงูู ุชูุงููุงุ ุฌุฑุจ ุจุตูุบุฉ ูุฎุชููุฉ ๐"})

    # --- ุชุดุบูู ---
if __name__ == "__main__":
        app.run()
